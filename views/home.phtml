<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Shop</title>
</head>
<body>
    <?php if(!isset($_SESSION['user']) || $_SESSION['user'] === false) {
    echo "<a href='index.php?c=login'>Login</a>";
    echo "   ";
    echo "<a href='index.php?c=register'>Register</a>";
    echo "   ";
} else {
    echo "<a href='index.php?c=cart'>Shopping Cart</a>";
    echo "   ";
    echo "<a href='index.php?c=login&logout=1'>Logout</a>";
    echo "   ";
}

    if(isset($_SESSION['user']) && $_SESSION['user'] !== false){
        echo "<p>Welcome, " . htmlspecialchars($_SESSION['user']->getUsername()) . "!</p>";
    }else{
        echo "<p>You are not logged in.</p>";
    }
    ?>

    <h1>Shop Page</h1>
    <p>Welcome to the shop!</p>
    <ul>
    <?php foreach($products as $product): ?>
        <li>
            <img src="<?php echo htmlspecialchars($product->getImage()); ?>" alt="<?php echo htmlspecialchars($product->getName()); ?>">
            <h2><?php echo htmlspecialchars($product->getName()); ?></h2>
            <p>Price: $<?php echo number_format($product->getPrice(), 2); ?></p>
            <p><?php echo htmlspecialchars($product->getDescription()); ?></p>
            <?php
            if($_SESSION['user']!== false){
                ?>
                <form action="index.php?c=cart" method="post">
                    <input type="hidden" name="product_id" value="<?php echo $product->getId(); ?>">
                    <input type="submit" value="Add to Cart">
                </form>
            <?php
            }else{
                echo "<p style='color: red;'>Please log in to add products to your cart.</p>";
            }
            ?>
        </li>
    <?php endforeach; ?>
    </ul>
</body>
</html>